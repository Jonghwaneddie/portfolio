<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Years</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable-dynamic-subset.css">
<style>
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  html, body {
    width: 100%; height: 100%; overflow: hidden;
    background: #fff;
    font-family: 'Montserrat', sans-serif;
    user-select: none;
    position: relative;
    margin-left: 120px; /* 메뉴 공간 확보 (PC) */
  }

  /* 모바일에서는 margin-left 줄임 */
  @media (max-width: 768px) {
    html, body {
      margin-left: 80px; /* 메뉴 공간 확보 (모바일) */
    }
  }

  .year-list a {
    position: fixed;
    font-size: 14px;
    font-family: 'Pretendard Variable', sans-serif;
    font-weight: 300;
    color: #000;
    text-decoration: none;
    cursor: pointer;
    white-space: nowrap;
    user-select: none;
    transition: color 0.3s ease;
  }
  .year-list a:hover {
    color: #555;
  }
</style>
</head>
<body>

  <div id="menu-container"></div>

  <div class="year-list">
    <a href="2025.html" id="year2025">2025</a>
    <a href="2024.html" id="year2024">2024</a>
    <a href="2023.html" id="year2023">2023</a>
    <a href="2022.html" id="year2022">2022</a>
    <a href="2021.html" id="year2021">2021</a>
  </div>

<script>
  // 메뉴 로딩
  fetch('menu.html')
    .then(res => res.ok ? res.text() : Promise.reject('Menu load failed'))
    .then(html => {
      document.getElementById('menu-container').innerHTML = html;
      window.toggleProjectMenu = function(e, submenuId) {
        e.preventDefault();
        const s1 = document.getElementById('projectSubmenu1');
        const s2 = document.getElementById('projectSubmenu2');
        const target = document.getElementById(submenuId);
        if (!target) return;
        if (submenuId === 'projectSubmenu1' && s2?.classList.contains('show')) {
          s2.classList.remove('show');
          s2.style.maxHeight = null;
        } else if (submenuId === 'projectSubmenu2' && s1?.classList.contains('show')) {
          s1.classList.remove('show');
          s1.style.maxHeight = null;
        }
        if (target.classList.contains('show')) {
          target.classList.remove('show');
          target.style.maxHeight = null;
        } else {
          target.classList.add('show');
          target.style.maxHeight = target.scrollHeight + "px";
        }
      };
    })
    .catch(err => console.error(err));

  const years = [
    { id: 'year2025' },
    { id: 'year2024' },
    { id: 'year2023' },
    { id: 'year2022' },
    { id: 'year2021' },
  ];

  function initialSlide(yearElems) {
    const vw = window.innerWidth;
    const vh = window.innerHeight;

    // 화면 크기에 따라 메뉴바 폭 설정
    const menuWidth = vw <= 768 ? 80 : 120;

    const slideDuration = 5000; // 5초
    const fps = 60;
    const totalFrames = slideDuration / (1000 / fps);

    const gap = 12;  // 숫자 사이 간격 (스페이스바 한 칸 정도)

    // y 위치를 중앙에서 150px 위로 조정
    const baseY = vh / 2 - 150;

    // 각 숫자 너비 배열
    const widths = yearElems.map(el => el.getBoundingClientRect().width);

    // 총 너비 계산 (숫자 너비 합 + 간격 포함)
    const totalWidth = widths.reduce((a, b) => a + b, 0) + gap * (yearElems.length - 1);

    // 시작점은 메뉴바 끝에서 40px 더 왼쪽으로 (음수일 수 있으니 최소 0으로 제한)
    const leftStart = Math.max(0, menuWidth - 40);

    // 목표점은 화면 오른쪽 끝 - 총 너비 - 40px 여백, 
    // 최소 메뉴바 폭 이상으로 제한
    const targetX = Math.max(menuWidth, vw - totalWidth - 40);

    let frame = 0;

    function step() {
      const progress = frame / totalFrames;

      // currentX는 leftStart에서 targetX까지 점진 이동
      const currentX = leftStart + (targetX - leftStart) * progress;

      yearElems.forEach((elem, idx) => {
        const x = currentX + widths.slice(0, idx).reduce((a,b) => a+b, 0) + gap * idx;
        elem.style.transition = 'none';
        elem.style.transform = `translate(${x}px, ${baseY}px)`;
      });

      frame++;
      if (frame <= totalFrames) {
        requestAnimationFrame(step);
      }
    }

    step();
  }

  window.addEventListener('load', () => {
    const yearElems = years.map(({ id }) => document.getElementById(id)).filter(Boolean);

    const vw = window.innerWidth;
    const vh = window.innerHeight;

    // 메뉴바 폭 설정
    const menuWidth = vw <= 768 ? 80 : 120;

    const widths = yearElems.map(el => el.getBoundingClientRect().width);
    // 출발 위치 (menuWidth - 40, 최소 0)
    const leftStart = Math.max(0, menuWidth - 40);
    const baseY = vh / 2 - 150;

    yearElems.forEach(elem => {
      elem.style.transform = `translate(${leftStart}px, ${baseY}px)`;
    });

    // 숫자들 5초동안 좌(출발위치)에서 우(도착위치) 위치로 이동
    initialSlide(yearElems);
  });
</script>

</body>
</html>
