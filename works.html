<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Random Walk Years</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;700&display=swap');
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #fff;
      font-family: 'Montserrat', sans-serif;
      margin-left: 120px; /* 메뉴 공간 확보 */
      position: relative;
      user-select: none;
    }

    /* 메뉴 자리 */
    #menu-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 120px;
      height: 100%;
      background: #eee;
      overflow-y: auto;
      padding: 10px;
      box-sizing: border-box;
    }

    /* 숫자들 컨테이너 */
    .year-list {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 40px;
      height: auto;
      transform: translate(-50%, -50%);
      user-select: none;
    }

    /* 숫자 스타일 */
    .year-list a {
      position: absolute;
      color: #000;
      text-decoration: none;
      font-weight: 700;
      font-size: 28px;
      cursor: pointer;
      writing-mode: vertical-rl;
      text-orientation: upright;
      user-select: none;
      left: 0;
      top: 0;
      transition: color 0.3s ease;
    }
    .year-list a:hover {
      color: #555;
    }
  </style>
</head>
<body>

  <div id="menu-container"></div>

  <div class="year-list" id="yearList">
    <a href="2021.html" id="year1">2021</a>
    <a href="2022.html" id="year2">2022</a>
    <a href="2023.html" id="year3">2023</a>
    <a href="2024.html" id="year4">2024</a>
    <a href="2025.html" id="year5">2025</a>
  </div>

  <script>
    // 메뉴 불러오기 및 메뉴 애니메이션 유지
    fetch('menu.html')
      .then(response => {
        if (!response.ok) throw new Error('메뉴 로딩 실패');
        return response.text();
      })
      .then(data => {
        document.getElementById('menu-container').innerHTML = data;

        window.toggleProjectMenu = function(e, submenuId) {
          e.preventDefault();

          const submenu1 = document.getElementById('projectSubmenu1');
          const submenu2 = document.getElementById('projectSubmenu2');
          const targetSubmenu = document.getElementById(submenuId);
          if (!targetSubmenu) return;

          if (submenuId === 'projectSubmenu1' && submenu2.classList.contains('show')) {
            submenu2.style.maxHeight = null;
            submenu2.classList.remove('show');
          } else if (submenuId === 'projectSubmenu2' && submenu1.classList.contains('show')) {
            submenu1.style.maxHeight = null;
            submenu1.classList.remove('show');
          }

          if (targetSubmenu.classList.contains('show')) {
            targetSubmenu.style.maxHeight = null;
            targetSubmenu.classList.remove('show');
          } else {
            targetSubmenu.style.maxHeight = targetSubmenu.scrollHeight + "px";
            targetSubmenu.classList.add('show');
          }
        }
      })
      .catch(error => {
        console.error('Menu load error:', error);
      });

    // 숫자 요소들 참조
    const years = [
      document.getElementById('year1'),
      document.getElementById('year2'),
      document.getElementById('year3'),
      document.getElementById('year4'),
      document.getElementById('year5')
    ];

    // 간격 및 초기 중앙 위치
    const spacing = 50;
    let centerX = window.innerWidth / 2;
    let centerY = window.innerHeight / 2;

    // 초기 위치 배열 (중앙 세로 정렬)
    const positions = years.map((el, idx) => {
      return {
        x: centerX,
        y: centerY + (idx - 2) * spacing
      };
    });

    const speed = 40; // px/s 속도
    const directions = [
      { x: 0, y: -1 }, // 위
      { x: 0, y: 1 },  // 아래
      { x: -1, y: 0 }, // 왼쪽
      { x: 1, y: 0 }   // 오른쪽
    ];
    const currentDirections = [];
    const directionChangeInterval = 2000; // 2초마다 방향 전환
    let lastDirectionChange = 0;

    // 각 숫자의 초기 방향 랜덤 지정
    for (let i = 0; i < years.length; i++) {
      currentDirections[i] = Math.floor(Math.random() * directions.length);
    }

    // 애니메이션 루프
    function animate(time = 0) {
      if (!lastDirectionChange) lastDirectionChange = time;

      const dt = time - lastDirectionChange;
      if (dt > directionChangeInterval) {
        lastDirectionChange = time;
        for (let i = 0; i < years.length; i++) {
          let newDir;
          do {
            newDir = Math.floor(Math.random() * directions.length);
          } while (newDir === currentDirections[i]);
          currentDirections[i] = newDir;
        }
      }

      for (let i = 0; i < years.length; i++) {
        const dir = directions[currentDirections[i]];
        let moveStep = speed * 0.016; // 약 60fps 기준

        positions[i].x += dir.x * moveStep;
        positions[i].y += dir.y * moveStep;

        // 화면 밖으로 나가지 않도록 경계 처리
        positions[i].x = Math.min(window.innerWidth - 30, Math.max(30, positions[i].x));
        positions[i].y = Math.min(window.innerHeight - 30, Math.max(30, positions[i].y));

        years[i].style.left = positions[i].x + 'px';
        years[i].style.top = positions[i].y + 'px';
      }

      // 10초까지만 움직임
      if (time < 10000) {
        requestAnimationFrame(animate);
      }
    }

    // 초기 위치 설정
    function initPositions() {
      for(let i = 0; i < years.length; i++) {
        years[i].style.left = positions[i].x + 'px';
        years[i].style.top = positions[i].y + 'px';
      }
    }

    window.onload = () => {
      initPositions();
      requestAnimationFrame(animate);
    };

    // 창 크기 변경 시 중앙 보정
    window.addEventListener('resize', () => {
      const newCenterX = window.innerWidth / 2;
      const newCenterY = window.innerHeight / 2;
      for(let i=0; i < positions.length; i++) {
        positions[i].x += (newCenterX - centerX);
        positions[i].y += (newCenterY - centerY);
        years[i].style.left = positions[i].x + 'px';
        years[i].style.top = positions[i].y + 'px';
      }
      centerX = newCenterX;
      centerY = newCenterY;
    });
  </script>

</body>
</html>
